(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{359:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(46),o=n.n(i),c=(n(61),n(5)),u=n(28),l=n(53),s=n(7),v=n(362),m=(n(62),n(13)),p=n(361),f=n(20),g=n(47),y=n.n(g),d=(n(63),function(e){var t=e.children,n=e.style,r=void 0===n?{}:n,i=e.className,o=e.maxHeight;return a.createElement("div",{className:y()("logger-container",i),style:Object(f.a)({},r,{maxHeight:o})},t)}),h=Object(m.ReactiveXComponent)()(function(e){var t=e.nb;return a.createElement("span",null,t)}),b=function(e){var t=e.nb$,n=e.avgMax,r=e.round,i=void 0===r?0:r;return a.createElement(d,{className:"avg-logger"},Object.keys(t).map(function(e){return a.createElement("div",{key:e},e,": ",a.createElement(h,{nb:t[e].pipe(Object(p.a)(function(e,t){var a=e.count,r=e.avg,i=Math.min(n-1,a),o=i+1;return{count:o,avg:(i*r+t)/o}},{count:0,avg:0}),Object(s.a)(function(e){return e.avg}),Object(s.a)(function(e){return Math.round(Math.pow(10,i)*e)/Math.pow(10,i)}))}))}))},O=n(49);function j(e){var t=function(e){return"00".concat(e).slice(-2)};return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())}var E=n(8),w=n(9),P=n(11),k=n(10),x=n(12),M=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(P.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).name="MousePositionEvent",n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"calculateModifications",value:function(e,t){var n=t.mousePosition,a=n.x,r=n.y;if(!e)return{};var i=e.mousePosition;return{"mousePosition.x":["+",a-i.x],"mousePosition.y":["+",r-i.y]}}},{key:"getScope",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"players.".concat(this.params.uuid)}}]),t}(c.GameEvent),S=n(16),G=n(54),N=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(P.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).name="MovementUpdateEvent",n.type=c.GameEventType.Local,n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"calculateModifications",value:function(e,t){var n=this,a=t.delta;return Object.assign.apply(Object,[{}].concat(Object(G.a)(Object.keys(e).map(function(t){return n.createChanges(e,t,a)}))))}},{key:"createChanges",value:function(e,t,n){var a,r=e[t],i=this._,o=r.playerPosition,c=o.x,u=o.y,l=r.mousePosition,s=l.x-c,v=l.y-u,m=Math.abs(s)+Math.abs(v);if(0===m)return{};var p=s/m,f=v/m,g=r.vector||{x:0,y:0},y=p*i(200,n),d=f*i(200,n);return a={},Object(S.a)(a,"".concat(t,".playerPosition.x"),["+",g.x]),Object(S.a)(a,"".concat(t,".playerPosition.y"),["+",g.y]),Object(S.a)(a,"".concat(t,".vector.x"),["+",y-g.x]),Object(S.a)(a,"".concat(t,".vector.y"),["+",d-g.y]),a}},{key:"getScope",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"players"}}]),t}(c.GameEvent),C=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(P.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).current=void 0,n.previous=void 0,n.countdown=0,n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"init",value:function(){var e=this;window.addEventListener("mousemove",function(t){var n=t.clientX,a=t.clientY;e.current={x:n,y:a}})}},{key:"loop",value:function(e){this.countdown-=e,this.events.trigger(new N({uuid:this.uuid,delta:e})),this.countdown>0||(this.countdown=t.INTERVAL,!this.current||this.previous&&this.previous.x===this.current.x&&this.previous.y===this.current.y||(this.events.trigger(new M({mousePosition:this.current,uuid:this.uuid})),this.previous=this.current))}}]),t}(c.GameController);C.INTERVAL=100;var L=n(48),$=n.n(L),A=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(P.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).name="PlayerInitEvent",n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"calculateModifications",value:function(e,t){var n=t.uuid,a=t.color;return Object(S.a)({},"players."+n,["=",{playerPosition:{x:200,y:200},mousePosition:{x:200,y:200},vector:{x:0,y:0},color:a}])}}]),t}(c.GameEvent),R=function(e){function t(){return Object(E.a)(this,t),Object(P.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(w.a)(t,[{key:"init",value:function(e,t){}},{key:"render",value:function(e,t){if(e){var n=this._;t.beginPath(),t.arc(n(e.x),n(e.y),20,0,2*Math.PI),t.fillStyle=e.color,t.fill()}}},{key:"update",value:function(e,t,n){if(e&&e.vector){var a=0;t&&t.prevPlayerPosition.x===e.playerPosition.x&&t.prevPlayerPosition.y===e.playerPosition.y&&(a=t.percentage);var r=Math.min(1,n/(1e3/I.ticksPerSecond)+a),i=e.playerPosition.x+r*e.vector.x,o=e.playerPosition.y+r*e.vector.y;return t&&t.x===i&&t.y===o?void 0:Object(f.a)({},t,{x:i,y:o,percentage:r,color:e.color,prevPlayerPosition:Object(f.a)({},e.playerPosition)})}}},{key:"getStateScope",value:function(){return"players.".concat(this.params.uuid)}},{key:"getViewStateScope",value:function(){return"players.".concat(this.params.uuid)}}]),t}(c.ViewItem),_=function(e){function t(){return Object(E.a)(this,t),Object(P.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(w.a)(t,[{key:"init",value:function(){var e=this;Object.keys(this.state.players).forEach(function(t){return e.createPlayerBall(t)}),this.events.on$(A).subscribe(function(t){e.createPlayerBall(t.params.uuid)});var t=$()();this.events.trigger(new A({uuid:this.party.uuid,color:t instanceof Array?t[0]:t}))}},{key:"loop",value:function(e){}},{key:"createPlayerBall",value:function(e){this.view.registerViewItem(new R({uuid:e}))}}]),t}(c.GameController),I=new c.GameEngine({initialViewState:{players:{}},ticksPerSecond:.5,framesPerSecond:60,initialState:{players:{}},controllers:[C,_],events:[M,A,N],socketConfig:{host:"p2p.s1r.io",rtcConfig:{iceServers:[{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.l.google.com:19302"}]}}}),T=I.logger,V=0,q=function(e){return Object(s.a)(function(t){return{type:e,message:t,id:++V,date:new Date}})},X=Object(m.ReactiveXComponent)({log:Object(O.merge)(T.info$.pipe(q("info")),T.warning$.pipe(q("warning")),T.error$.pipe(q("error")),T.debug$.pipe(q("debug"))).pipe(Object(p.a)(function(e,t){return e.unshift(t),e.length>1e3&&e.pop(),e},[]))},{log:[]})(function(e){var t=e.log;return a.createElement(d,{className:"basic-logger"},t.map(function(e){var t=e.type,n=e.message,r=e.id,i=e.date;return a.createElement("div",{key:r,className:t+" basic-log-item",onClick:function(){return console.log({type:t,message:n,id:r,date:i})}},a.createElement("span",null,j(i)," "),a.createElement("span",null,"[",t.toUpperCase(),"] "),n)}))}),B=Object(m.ReactiveXComponent)()(function(e){var t=e.values,n=void 0===t?[]:t;return a.createElement("div",{className:"log-item"},n&&n.map(function(e){return a.createElement("div",{key:e.eventUuid,onMouseDown:function(){return console.log(e)},className:"event-item"},a.createElement("span",null,j(e.date)," "),a.createElement("span",null,e.event.name))}))}),U=function(e){var t=e.keep;return a.createElement(d,null,a.createElement(B,{values:I.logger.on$(c.GameEventManager.EVENT_TRIGGER_LOG).pipe(Object(p.a)(function(e,n){return e.unshift(Object(f.a)({},n,{date:new Date})),e.length>t&&e.pop(),e},[]))}))},D=n(363),H=n(29);H.obsidian.hljs.background="rgba(0,0,0,0.5)",H.obsidian.hljs.margin="-5px";var J=Object(m.ReactiveXComponent)()(function(e){var t=e.item,n=void 0===t?{}:t;return a.createElement(d,{maxHeight:"none"},a.createElement(D.a,{language:"javascript",style:H.obsidian},JSON.stringify(n,void 0,4)))}),Q=Object(m.ReactiveXComponent)({queue:I.logger.on$(c.ModificationQueue.QUEUE_LOG)},{queue:[]})(function(e){var t=e.queue,n=void 0===t?[]:t;return a.createElement(d,{className:"modification-queue-log"},a.createElement("div",{className:"log-item"},n.map(function(e,t){return a.createElement("div",{key:t,onMouseDown:function(){return console.log(e)},className:"queue-item"},e.request.uuid)})))}),F=Object(u.a)(Object(s.a)(function(e){return e.delta}),Object(l.filter)(function(e){return 0!==e}),Object(s.a)(function(e){return 1e3/e}),Object(v.a)(1));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(function(){return r.a.createElement("div",{className:"App",ref:function(e){return e&&e.appendChild(I.viewElement)}},r.a.createElement("div",{className:"top-left"},r.a.createElement("h6",null,"Log:"),r.a.createElement(X,null),r.a.createElement("h6",null,"Event Log:"),r.a.createElement("div",{className:"event-log"},r.a.createElement(U,{keep:20}))),r.a.createElement("div",{className:"top-right fps"},r.a.createElement(b,{nb$:{FPS:I.logger.on$(c.GameEngine.FRAME_LOOP_LOG).pipe(F),TPS:I.logger.on$(c.GameEngine.TICK_LOOP_LOG).pipe(F)},avgMax:20,round:1}),r.a.createElement("h6",null,"Game State:"),r.a.createElement(J,{item:I.logger.on$(c.GameState.STATE_LOG)})),r.a.createElement("div",{className:"bottom-center"},r.a.createElement("h6",null,"Modification Queue"),r.a.createElement(Q,null)))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},55:function(e,t,n){e.exports=n(359)},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){}},[[55,1,2]]]);
//# sourceMappingURL=main.dc42c5a9.chunk.js.map